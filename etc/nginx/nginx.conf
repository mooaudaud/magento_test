# For more information on configuration, see:
#   * Official English Documentation: http://nginx.org/en/docs/
#   * Official Russian Documentation: http://nginx.org/ru/docs/

#user  www-data;
worker_processes auto;

error_log  /var/log/nginx/error.log;
pid        /var/run/nginx.pid;

events {
    worker_connections  1024;
    use epoll;
    multi_accept on;
}
worker_rlimit_nofile 1024;

http {
  
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    
log_format custom '$remote_addr - $remote_user [$time_local] '
                   '"$request_method $scheme://$host$request_uri $server_protocol" ' 
		  '"$request" $status $body_bytes_sent '
		  '"$http_referer" "$http_user_agent" '
		  '"$http_x_forwarded_for" ';


    access_log  /var/log/nginx/access.log custom;
    sendfile        on;
    tcp_nopush      on;
    tcp_nodelay     on;
    keepalive_timeout  120;

    ## GZIP ADD DIRECTIVE AT VHOSTS.D/GZIP.COF
    server_tokens off;
    ignore_invalid_headers on;
    client_header_timeout  3m;
    client_body_timeout 3m;
    send_timeout     3m;

    open_file_cache max=200000 inactive=20s;
    open_file_cache_valid 30s;
    open_file_cache_min_uses 2;
    open_file_cache_errors on;
    fastcgi_buffer_size 128k;
    fastcgi_buffers 256 16k;
    fastcgi_read_timeout 300;
    fastcgi_connect_timeout 3s;
    fastcgi_send_timeout 120s;
    reset_timedout_connection on;
    proxy_cookie_path / "/; secure";
    client_max_body_size 20M;
    
proxy_buffer_size   128k;
proxy_buffers   4 256k;
proxy_busy_buffers_size   256k;
  # fastcgi_cache_path /etc/nginx-cache levels=1:2 keys_zone=phpcache:100m inactive=60m;
  # fastcgi_cache_key "$scheme$request_method$host$request_uri";


    # Load modular configuration files from the /etc/nginx/conf.d directory.
    # See http://nginx.org/en/docs/ngx_core_module.html#include
    # for more information.
    include /etc/nginx/conf.d/*.conf;
    include /etc/nginx/vhosts.d/*.conf;

    index   index.html index.htm;

    gzip on;
        gzip_disable "msie6";

        gzip_vary on;
        gzip_proxied any;
        gzip_comp_level 6;
        gzip_buffers 16 8k;
        gzip_http_version 1.1;
#       gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;
gzip_types
        text/css
        text/plain
        text/javascript
        application/javascript
        application/json
        application/x-javascript
        application/xml
        application/xml+rss
        application/xhtml+xml
        application/x-font-ttf
        application/x-font-opentype
        application/vnd.ms-fontobject
        image/svg+xml
        image/x-icon
        application/rss+xml
        application/atom_xml;
}


